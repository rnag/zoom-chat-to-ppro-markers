addStringMethods();var project=app.project,sequence=project.activeSequence;sequence||exitErr("Script requires an active sequence!");var sequenceMarkers=sequence.markers,userPrompt="Select *.chat file";if("Windows"==File.fs)var chatFiles=File.openDialog(userPrompt,"CHAT Files: *.chat",!0);else var chatFiles=File.openDialog(userPrompt,checkMacFileType,!0);var colors={GREEN:0,RED:1,PURPLE:2,ORANGE:3,YELLOW:4,WHITE:5,BLUE:6,CYAN:7};function main(){var e=chatFiles.length;e||exitErr("No *.chat files selected!");for(var r=0;r<e;r++){var t=chatFiles[r];if(t instanceof File&&t.exists){var n=timeInSec=user=null;readTextFile(t,function(e){var r=e.split("	"),t=convertTimecodeToSeconds(r[0].trim());3===r.length&&t?(n&&createMarker(timeInSec,user,n),timeInSec=t,user=r[1].trim().slice(0,-1),n=r[2].trim()):n+="\n"+e}),n&&createMarker(timeInSec,user,n)}}}function checkMacFileType(e){return!e instanceof Folder||(index=e.name.lastIndexOf("."),"chat"==(ext=e.name.substring(index+1))||"CHAT"==ext)}function createMarker(e,r,t){var n,o=sequenceMarkers.createMarker(e),c=t.toLowerCase().split(" ");o.name=r,o.comments=t;for(var i=colors.GREEN,a=0;a<c.length;a++)"cut"===(n=c[a])||"edit"===n?i=colors.RED:"fix"===n||"replace"===n?i=colors.ORANGE:"audio"===n||"sound"===n?i=colors.YELLOW:"reacted"==n&&(i=colors.PURPLE);o.setColorByIndex(i)}function exitErr(e){alert(e),exit(-1)}function addStringMethods(){void 0===String.prototype.trim&&(String.prototype.trim=function(){return String(this).replace(/^\s+|\s+$/g,"")})}function convertTimecodeToSeconds(e){return 3===(myT=e.split(":")).length&&(hours=3600*parseInt(myT[0]),minutes=60*parseInt(myT[1]),seconds=parseInt(myT[2]),!(isNaN(hours)||isNaN(minutes)||isNaN(seconds))&&(totalInSeconds=hours+minutes+seconds))}function readTextFile(e,r){var t=e instanceof File?e:new File(e);if(!t.exists)return!1;t.open("r")||exitErr("Unable to open file "+decodeURI(t.name)),t.encoding||(t.encoding="UTF-8");var n=t.read();t.close();var o=n.split("\n");if("function"==typeof r)for(var c=0;c<o.length;c++)r(o[c],c);return n}main();